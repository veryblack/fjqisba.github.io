I"]<h3 id="yara介绍">YARA介绍</h3>
<p>YARA是一款特征码扫描工具,可用于快速识别,可以用于病毒分析、等领域.</p>

<h3 id="yara安装">YARA安装</h3>
<p>在官方GITHUB上下载一份Release后使用VS进行编译:</p>

<p>https://github.com/VirusTotal/yara</p>

<p>得到yarac64.exe和yara64.exe文件即可(我编译选择的是x64).</p>

<h3 id="yara规则介绍">YARA规则介绍</h3>
<pre><code class="language-YARA">rule ExampleRule
{
    strings:
        $my_text_string = "text here"
        $my_hex_string = { E2 34 A1 C8 23 FB }

    condition:
        $my_text_string or $my_hex_string
}
</code></pre>
<p>这就是YARA的规则,具体介绍在https://yara.readthedocs.io/en/v3.8.1/writingrules.html</p>
<h4 id="nocase-不区分大小写">nocase 不区分大小写</h4>
<pre><code class="language-YARA">strings:
        $text_string = "foobar" nocase
</code></pre>
<p>这样的话,FooBar,fOoBar都是可以匹配到的</p>
<h4 id="wide-匹配宽字符">wide 匹配宽字符</h4>
<pre><code class="language-YARA">    strings:
        $wide_string = "Borland" wide
</code></pre>
<p>也可以使用
<code class="highlighter-rouge">$wide_and_ascii_string = "Borland" wide ascii</code>
这样代表两种情况都进行匹配.</p>

<h4 id="xor-异或">xor 异或</h4>
<pre><code class="language-YARA">rule XorExample1
{
    strings:
        $xor_string = "This program cannot" xor

    condition:
       $xor_string
}
</code></pre>
<p>此功能即体现出了YARA的强大的能力了,因为病毒经常利用一个简单的异或来解密代码.
YARA会处理所有与规则异或的字符串.</p>
:ET