---
layout: post
title: 'YARA入门'
date: 2019-01-06
categories: MarkDown
tags: YARA 特征码识别 入门教程
---
### YARA介绍
YARA是一款特征码扫描工具,可用于快速识别,可以用于病毒分析、等领域.

### YARA安装
在官方GITHUB上下载一份Release后使用VS进行编译:

https://github.com/VirusTotal/yara

得到yarac64.exe和yara64.exe文件即可(我编译选择的是x64).

### YARA规则介绍
```YARA
rule ExampleRule
{
    strings:
        $my_text_string = "text here"
        $my_hex_string = { E2 34 A1 C8 23 FB }

    condition:
        $my_text_string or $my_hex_string
}
```
这就是YARA的规则,具体介绍在https://yara.readthedocs.io/en/v3.8.1/writingrules.html
#### nocase 不区分大小写
```YARA
strings:
        $text_string = "foobar" nocase
```
这样的话,FooBar,fOoBar都是可以匹配到的
#### wide 匹配宽字符
```YARA
    strings:
        $wide_string = "Borland" wide
```
也可以使用
```$wide_and_ascii_string = "Borland" wide ascii```
这样代表两种情况都进行匹配.

#### xor 异或
```YARA
rule XorExample1
{
    strings:
        $xor_string = "This program cannot" xor

    condition:
       $xor_string
}
```
此功能即体现出了YARA的强大的能力了,因为病毒经常利用一个简单的异或来解密代码.
YARA会处理所有与规则异或的字符串.
